#!/bin/bash
sudo pacman -Rns $(pacman -Qtdq) --noconfirm 2>/dev/null; sudo pacman -Scc --noconfirm; STAY_INTEL=$(lscpu | grep -ic "Intel"); STAY_AMD=$(lspci | grep -icE "amd|radeon"); STAY_NVIDIA=$(lspci | grep -ic "nvidia"); [[ $STAY_INTEL -eq 0 ]] && sudo rm -rf /usr/lib/firmware/intel* 2>/dev/null; [[ $STAY_AMD -eq 0 ]] && sudo rm -rf /usr/lib/firmware/amdgpu /usr/lib/firmware/radeon 2>/dev/null; [[ $STAY_NVIDIA -eq 0 ]] && sudo rm -rf /usr/lib/firmware/nvidia 2>/dev/null; sudo rm -rf /usr/lib/firmware/{liquidio,qcom,netronome,nfp,mellanox,kaweth,ti-connectivity,mediatek,marvell,cavium,qed} 2>/dev/null; sudo sed -i '/^#en_.*\.UTF-8 UTF-8/s/^#//' /etc/locale.gen; sudo rm -f /usr/lib/locale/locale-archive; sudo locale-gen; sudo find /usr/share/locale/ -maxdepth 1 -mindepth 1 -not -name 'en*' -not -name 'locale.alias' -exec rm -rf {} + 2>/dev/null; sudo find /usr/share/{doc,man,info,gtk-doc} -type f -delete 2>/dev/null; sudo find /usr/lib/modules -name "*.ko" -exec strip --strip-debug {} + 2>/dev/null; sudo journalctl --vacuum-size=50M; sudo sed -i 's/#SystemMaxUse=/SystemMaxUse=50M/' /etc/systemd/journald.conf; sudo systemctl restart systemd-journald; rm -rf ~/.cache/* 2>/dev/null; sync
