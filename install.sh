#!/bin/bash
sudo pacman -Syu --noconfirm --needed && echo "System updated." && HW_TYPE=$(cat /sys/class/dmi/id/product_name) && CPU_VENDOR=$(grep -m1 'vendor_id' /proc/cpuinfo) && IS_BROADCOM=$(lspci -n | grep -c "14e4:") && DRIVERS="sof-firmware alsa-firmware tlp thermald xf86-input-libinput linux-headers" && [[ "$CPU_VENDOR" =~ "GenuineIntel" ]] && DRIVERS+=" intel-ucode vulkan-intel mesa" || DRIVERS+=" amd-ucode mesa" && [[ "$IS_BROADCOM" -gt 0 ]] && DRIVERS+=" broadcom-wl" && echo "Hardware detected: $HW_TYPE with $CPU_VENDOR. Installing drivers..." && sudo pacman -S --noconfirm --needed $DRIVERS xorg-server openbox lightdm lightdm-gtk-greeter lxqt-session lxqt-panel lxqt-config lxqt-qtplugin lxqt-powermanagement lxqt-notificationd lxqt-policykit lxqt-globalkeys lxqt-runner lxqt-themes lximage-qt pcmanfm-qt qterminal breeze-icons gvfs xdg-utils picom falkon neovim fastfetch htop mpv featherpad kcalc pipewire-audio pavucontrol-qt alsa-utils bluez bluez-utils blueman networkmanager network-manager-applet && echo "All packages installed successfully." && sudo systemctl enable lightdm bluetooth.service NetworkManager.service tlp.service thermald.service && echo "System services enabled." && sudo sed -i 's/#greeter-session=.*/greeter-session=lightdm-gtk-greeter/' /etc/lightdm/lightdm.conf && mkdir -p ~/.config/pcmanfm-qt/lxqt/ && echo -e "[General]\ntrust_all_desktop_files=true" > ~/.config/pcmanfm-qt/lxqt/settings.conf && mkdir -p ~/.config/autostart && echo -e "[Desktop Entry]\nType=Application\nExec=picom -b\nName=Picom" > ~/.config/autostart/picom.desktop && echo -e "[Desktop Entry]\nType=Application\nExec=nm-applet\nName=Network Manager" > ~/.config/autostart/nm-applet.desktop && echo -e "[Desktop Entry]\nType=Application\nExec=blueman-applet\nName=Bluetooth Manager" > ~/.config/autostart/blueman.desktop && echo "User configurations created." && sudo chown -R $USER:$USER ~/.config && sudo pacman -Scc --noconfirm && echo "Cleanup complete. Rebooting..." && sync && sleep 2 && sudo reboot
